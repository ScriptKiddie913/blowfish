<!DOCTYPE html>
<html>
<head>
    <title>Test Edge Function</title>
</head>
<body>
    <h1>Test Edge Function</h1>
    <button onclick="testFunction()">Test Function</button>
    <div id="result"></div>

    <script>
        // SECURITY: Replace these with your actual values - DO NOT commit real keys
        const SUPABASE_URL = 'YOUR_SUPABASE_URL_HERE';
        const SUPABASE_ANON_KEY = 'YOUR_SUPABASE_ANON_KEY_HERE';

        // Helper function to escape HTML and prevent XSS
        function escapeHtml(unsafe) {
            const div = document.createElement('div');
            div.textContent = unsafe;
            return div.innerHTML;
        }

        async function testFunction() {
            const url = `${SUPABASE_URL}/functions/v1/leaked-credentials-search`;
            const resultDiv = document.getElementById('result');
            
            try {
                console.log('Testing function with basic request...');
                const response = await fetch(url, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${SUPABASE_ANON_KEY}`
                    },
                    body: JSON.stringify({
                        searchTerm: 'test@example.com',
                        searchType: 'email'
                    })
                });

                console.log('Response status:', response.status);
                console.log('Response headers:', [...response.headers.entries()]);
                
                const text = await response.text();
                console.log('Response text:', text);
                
                // Use textContent to prevent XSS
                resultDiv.innerHTML = '';
                const statusP = document.createElement('p');
                statusP.textContent = `Status: ${response.status}`;
                const responseP = document.createElement('p');
                responseP.textContent = `Response: ${text}`;
                
                resultDiv.appendChild(statusP);
                resultDiv.appendChild(responseP);
            } catch (error) {
                console.error('Error:', error);
                resultDiv.textContent = `Error: ${error.message}`;
            }
        }
    </script>
</body>
</html>